import requests
import time
start = time.time()

def ligands_from_pdbs(pdbs):
    pload = pdbs
    response = requests.post('https://www.ebi.ac.uk/pdbe/api/pdb/entry/binding_sites/',data = pload)
    pdb_ligand_dic={}
    for pdb in response.json():
        sites= response.json()[pdb]
        ligand_list=[]
        for site in sites:
            site_id_name=site["site_id"]
            site_residues=site["site_residues"]
            site_details=site["details"].split(" ")[4]
            for ligand in site_residues:
                ligand_tuple=(site_details,site_id_name,ligand["chem_comp_id"],ligand["chain_id"],ligand["residue_number"])
                ligand_list.append(ligand_tuple)
        pdb_ligand_dic[pdb]=ligand_list
    return pdb_ligand_dic

#Prueba de tiempo
# Cada request tarda 1.0866 segundos
a='5OF4 5GPQ 5T38 5UDS 5L0R 5GY8 5MZJ 5Y79 5W8C 5P92 5MKA 5WDQ 5W9J 5N69 5NPE 5GZY 5X9H 5MZ8 5O4N 5LQ9 5U4Z 5MOC 5X9S 5O5S 5GO2 5NM8 5X4V 5XPZ 5GZS 2M9A 5VPD 5KVB 5P9B 5Y0A 5MYG 5WF9 5U6C 5Y2Y 5VVC 5W93 5N4Q 5VBG 5XHE 2NDB 5LE6 6ALG 5TZ9 5VQ4 5ODR 5H6B 5K9B 5GV3 5MHD 5VP0 5OEJ 5WO8 5T4R 5LLH 5GV2 5U65 5V5N 5VVK 5NGG 5T99 5WHK 5U0D 5MPR 5KU6 5V5K 5OFW 5GV1 5VLL 5TZO 5TI3 5VQ3 5U98 5V60 5XEC 5T9I 5LL9 6AQH 5TY9 5L0A 5N63 5WBM 5VD3 5IXV 5VHS 5XTR 5M3A 5O4E 5MYI 5MFN 5WRJ 5VSH 5X7O 5GS7 5M7M 5U4G '
b='5OF4 5GPQ 5T38 5UDS 5L0R 5GY8 5MZJ 5Y79 5W8C 5P92 5MKA 5WDQ 5W9J 5N69 5NPE 5GZY 5X9H 5MZ8 5O4N 5LQ9 5U4Z 5MOC 5X9S 5O5S 5GO2 5NM8 5X4V 5XPZ 5GZS 2M9A 5VPD 5KVB 5P9B 5Y0A 5MYG 5WF9 5U6C 5Y2Y 5VVC 5W93 5N4Q 5VBG 5XHE 2NDB 5LE6 6ALG 5TZ9 5VQ4 5ODR 5H6B 5K9B 5GV3 5MHD 5VP0 5OEJ 5WO8 5T4R 5LLH 5GV2 5U65 5V5N 5VVK 5NGG 5T99 5WHK 5U0D 5MPR 5KU6 5V5K 5OFW 5GV1 5VLL 5TZO 5TI3 5VQ3 5U98 5V60 5XEC 5T9I 5LL9 6AQH 5TY9 5L0A 5N63 5WBM 5VD3 5IXV 5VHS 5XTR 5M3A 5O4E 5MYI 5MFN 5WRJ 5VSH 5X7O 5GS7 5M7M 5U4G '
c='5OF4 5GPQ 5T38 5UDS 5L0R 5GY8 5MZJ 5Y79 5W8C 5P92 5MKA 5WDQ 5W9J 5N69 5NPE 5GZY 5X9H 5MZ8 5O4N 5LQ9 5U4Z 5MOC 5X9S 5O5S 5GO2 5NM8 5X4V 5XPZ 5GZS 2M9A 5VPD 5KVB 5P9B 5Y0A 5MYG 5WF9 5U6C 5Y2Y 5VVC 5W93 5N4Q 5VBG 5XHE 2NDB 5LE6 6ALG 5TZ9 5VQ4 5ODR 5H6B 5K9B 5GV3 5MHD 5VP0 5OEJ 5WO8 5T4R 5LLH 5GV2 5U65 5V5N 5VVK 5NGG 5T99 5WHK 5U0D 5MPR 5KU6 5V5K 5OFW 5GV1 5VLL 5TZO 5TI3 5VQ3 5U98 5V60 5XEC 5T9I 5LL9 6AQH 5TY9 5L0A 5N63 5WBM 5VD3 5IXV 5VHS 5XTR 5M3A 5O4E 5MYI 5MFN 5WRJ 5VSH 5X7O 5GS7 5M7M 5U4G '
d='5OF4 5GPQ 5T38 5UDS 5L0R 5GY8 5MZJ 5Y79 5W8C 5P92 5MKA 5WDQ 5W9J 5N69 5NPE 5GZY 5X9H 5MZ8 5O4N 5LQ9 5U4Z 5MOC 5X9S 5O5S 5GO2 5NM8 5X4V 5XPZ 5GZS 2M9A 5VPD 5KVB 5P9B 5Y0A 5MYG 5WF9 5U6C 5Y2Y 5VVC 5W93 5N4Q 5VBG 5XHE 2NDB 5LE6 6ALG 5TZ9 5VQ4 5ODR 5H6B 5K9B 5GV3 5MHD 5VP0 5OEJ 5WO8 5T4R 5LLH 5GV2 5U65 5V5N 5VVK 5NGG 5T99 5WHK 5U0D 5MPR 5KU6 5V5K 5OFW 5GV1 5VLL 5TZO 5TI3 5VQ3 5U98 5V60 5XEC 5T9I 5LL9 6AQH 5TY9 5L0A 5N63 5WBM 5VD3 5IXV 5VHS 5XTR 5M3A 5O4E 5MYI 5MFN 5WRJ 5VSH 5X7O 5GS7 5M7M 5U4G '
e='5OF4 5GPQ 5T38 5UDS 5L0R 5GY8 5MZJ 5Y79 5W8C 5P92 5MKA 5WDQ 5W9J 5N69 5NPE 5GZY 5X9H 5MZ8 5O4N 5LQ9 5U4Z 5MOC 5X9S 5O5S 5GO2 5NM8 5X4V 5XPZ 5GZS 2M9A 5VPD 5KVB 5P9B 5Y0A 5MYG 5WF9 5U6C 5Y2Y 5VVC 5W93 5N4Q 5VBG 5XHE 2NDB 5LE6 6ALG 5TZ9 5VQ4 5ODR 5H6B 5K9B 5GV3 5MHD 5VP0 5OEJ 5WO8 5T4R 5LLH 5GV2 5U65 5V5N 5VVK 5NGG 5T99 5WHK 5U0D 5MPR 5KU6 5V5K 5OFW 5GV1 5VLL 5TZO 5TI3 5VQ3 5U98 5V60 5XEC 5T9I 5LL9 6AQH 5TY9 5L0A 5N63 5WBM 5VD3 5IXV 5VHS 5XTR 5M3A 5O4E 5MYI 5MFN 5WRJ 5VSH 5X7O 5GS7 5M7M 5U4G'
aa=a+b+c+d+e
aa=aa.split(" ")
for i in aa:
    print(ligands_from_pdbs(i))

end = time.time()
print(end - start)
